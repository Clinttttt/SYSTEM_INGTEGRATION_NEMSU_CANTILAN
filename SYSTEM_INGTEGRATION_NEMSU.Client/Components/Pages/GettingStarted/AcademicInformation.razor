@inject PageState pageState
@inject IStudentRecordApiCommand studentRecordApi
@rendermode InteractiveServer


<div class="space-y-4">
    <div class="text-center mb-6">
        <div class="w-14 h-14 bg-gradient-to-br from-cyan-500 to-teal-600 rounded-full flex items-center justify-center mx-auto mb-3 shadow-lg">
            <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5z"></path>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"></path>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5zm0 0l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14zm-4 6v-7.5l4-2.222"></path>
            </svg>
        </div>
        <h2 class="text-xl font-bold text-slate-600 mb-1">Academic Information</h2>
        <p class="text-sm text-slate-500">Provide your academic background and program details</p>
    </div>

    <EditForm Model="@Academicinformation" OnValidSubmit="@HandleAcademicInformation" FormName="Academic">
        <DataAnnotationsValidator />
        <div class="space-y-4 ">


            <div>
                <label class="block text-sm font-semibold text-slate-600 mb-2">Student Type</label>
                <InputSelect @bind-Value="Academicinformation.StudentType"
                             class="w-full px-3 py-2.5 border border-slate-300 rounded-lg text-sm text-slate-600 bg-white
                               focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 outline-none transition-all
                               hover:border-slate-400">
                    <option selected value="" class="text-slate-500">Select Type</option>
                    <option value="@StudentTypeChoice.New">New Student</option>
                    <option value="@StudentTypeChoice.Transferee">Transferee</option>
                    <option value="@StudentTypeChoice.Returning">Returning Student</option>
                    <option value="@StudentTypeChoice.Old">Old Student</option>
                </InputSelect>
                <ValidationMessage For="@(()=> Academicinformation.StudentType)" class="text-red-600 text-xs mt-1" />
            </div>


            <div>
                <label class="block text-sm font-semibold text-slate-600 mb-2">Year Level</label>
                <InputSelect @bind-Value="Academicinformation.YearLevel"
                             class="w-full px-3 py-2.5 border border-slate-300 rounded-lg text-sm text-slate-600 bg-white
                               focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 outline-none transition-all
                               hover:border-slate-400">
                    <option selected value="" class="text-slate-500">Select Year</option>
                    <option value="@YearLevelChoice.First_Year">1st Year</option>
                    <option value="@YearLevelChoice.Second_Year">2nd Year</option>
                    <option value="@YearLevelChoice.Third_Year">3rd Year</option>
                    <option value="@YearLevelChoice.Fourth_Year">4th Year</option>
                </InputSelect>
                <ValidationMessage For="@(()=> Academicinformation.YearLevel)" class="text-red-600 text-xs mt-1" />
            </div>


            <div>
                <label class="block text-sm font-semibold text-slate-600 mb-2">Semester</label>
                <InputSelect @bind-Value="Academicinformation.Semester"
                             class="w-full px-3 py-2.5 border border-slate-300 rounded-lg text-sm text-slate-600 bg-white
                               focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 outline-none transition-all
                               hover:border-slate-400">
                    <option selected value="" class="text-slate-500">Select Semester</option>
                    <option value="@SemesterChoice.First_Semester">First Semester</option>
                    <option value="@SemesterChoice.Second_Semester">Second Semester</option>
                </InputSelect>
                <ValidationMessage for="@(()=> Academicinformation.Semester)" class="text-red-600 text-xs mt-1" />
            </div>


            <div>
                <label class="block text-sm font-semibold text-slate-600 mb-2">Program</label>
                <InputSelect @bind-Value="Academicinformation.Program"
                             class="w-full px-3 py-2.5 border border-slate-300 rounded-lg text-sm text-slate-600 bg-white
           focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 outline-none transition-all
           hover:border-slate-400">

                    <option selected value="" class="text-slate-500">Select Program</option>

                    <!-- DCS -->
                    <option value="@CourseProgram.Computer_Engineering">BS Computer Engineering</option>
                    <option value="@CourseProgram.Computer_Science">BS Computer Science</option>
                    <option value="@CourseProgram.Information_Technology">BS Information Technology</option>

                    <!-- DIT -->
                    <option value="@CourseProgram.BSIT_ArchitecturalDraftingTechnology">BSIT Major in Architectural Drafting Technology</option>
                    <option value="@CourseProgram.BSIT_AutomotiveTechnology">BSIT Major in Automotive Technology</option>
                    <option value="@CourseProgram.BSIT_ComputerTechnology">BSIT Major in Computer Technology</option>
                    <option value="@CourseProgram.BSIT_ElectricalTechnology">BSIT Major in Electrical Technology</option>
                    <option value="@CourseProgram.BSIT_ElectronicsTechnology">BSIT Major in Electronics Technology</option>
                    <option value="@CourseProgram.BSIT_FoodTechnology">BSIT Major in Food Technology</option>
                    <option value="@CourseProgram.BSIT_GarmentsTechnology">BSIT Major in Garments Technology</option>
                    <option value="@CourseProgram.BSIT_MechanicalTechnology">BSIT Major in Mechanical Technology</option>

                    <!-- DGTT - BSEd -->
                    <option value="@CourseProgram.BSEd_Filipino">BSEd Major in Filipino</option>
                    <option value="@CourseProgram.BSEd_English">BSEd Major in English</option>
                    <option value="@CourseProgram.BSEd_Mathematics">BSEd Major in Mathematics</option>
                    <option value="@CourseProgram.BSEd_Science">BSEd Major in Science</option>

                    <!-- DGTT - BTVTEd -->
                    <option value="@CourseProgram.BTVTEd_AutomotiveTechnology">BTVTEd Major in Automotive Technology</option>
                    <option value="@CourseProgram.BTVTEd_GarmentsAndFashionDesign">BTVTEd Major in Garments and Fashion Design</option>
                    <option value="@CourseProgram.BTVTEd_ElectricalTechnology">BTVTEd Major in Electrical Technology</option>
                    <option value="@CourseProgram.BTVTEd_ElectronicsTechnology">BTVTEd Major in Electronics Technology</option>
                    <option value="@CourseProgram.BTVTEd_FoodAndServicesManagement">BTVTEd Major in Food and Services Management</option>
                    <option value="@CourseProgram.BTVTEd_MechanicalTechnology">BTVTEd Major in Mechanical Technology</option>

                    <!-- DGTT - BTLEd -->
                    <option value="@CourseProgram.BTLEd_HomeEconomics">BTLEd Major in Home Economics</option>
                    <option value="@CourseProgram.BTLEd_IndustrialArts">BTLEd Major in Industrial Arts</option>

                    <!-- CCJE -->
                    <option value="@CourseProgram.BS_Criminology">BS Criminology</option>

                    <!-- DBM -->
                    <option value="@CourseProgram.BSHM_HospitalityManagement">BS Hospitality Management</option>
                    <option value="@CourseProgram.BSTM_TourismManagement">BS Tourism Management</option>
                    <option value="@CourseProgram.BSBA_FinancialManagement">BSBA Major in Financial Management</option>
                    <option value="@CourseProgram.BSBA_HumanResourceManagement">BSBA Major in Human Resource Management</option>

                </InputSelect>

                <ValidationMessage For="@(()=> Academicinformation.Program)" class="text-red-600 text-xs mt-1" />
            </div>





            <div>
                <label class="block text-sm font-semibold text-slate-600 mb-2">Strand (Senior High School)</label>
                <InputSelect @bind-Value="Academicinformation.Strand"
                             class="w-full px-3 py-2.5 border border-slate-300 rounded-lg text-sm text-slate-600 bg-white
                               focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 outline-none transition-all
                               hover:border-slate-400">
                    <option selected value="" class="text-slate-500">Select Strand</option>
                    <option value="@StrandChoice.Stem">STEM - Science, Technology, Engineering and Mathematics</option>
                    <option value="@StrandChoice.Abm">ABM - Accountancy, Business and Management</option>
                    <option value="@StrandChoice.Humss">HUMSS - Humanities and Social Sciences</option>
                    <option value="@StrandChoice.Gas">GAS - General Academic Strand</option>
                    <option value="@StrandChoice.Tvl">TVL - Technical-Vocational-Livelihood</option>
                </InputSelect>
                <ValidationMessage For="@(()=> Academicinformation.Strand)" class="text-red-600 text-xs mt-1" />
            </div>


            @if (!string.IsNullOrEmpty(Error))
            {
                <div class="bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg text-sm">
                    @Error
                </div>
            }


            <div class="flex justify-between gap-3 pt-4 border-t border-slate-200">
                <button type="button" @onclick="()=> HandleSaveAsDraft()"
                        class="flex-1 px-4 text-sm flex gap-2 py-2.5 border border-slate-300 text-slate-700 rounded-lg font-medium
                               hover:bg-slate-50 transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                    </svg>
                    Save as Draft
                </button>
                <button type="submit"
                        class="flex-1 px-4 py-2.5 text-sm  bg-gradient-to-br from-cyan-600 to-teal-600 text-white rounded-lg font-medium
                               hover:from-cyan-700 flex gap-2 hover:to-teal-800 transition-all shadow-md items-center justify-center">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    Save
                </button>
            </div>
        </div>
    </EditForm>
</div>

@code {
    public AcademicInformationDto Academicinformation { get; set; } = new();
    public string? Error { get; set; }

    public async Task HandleAcademicInformation()
    {
        Error = null;
        Academicinformation.Savestatus = SaveStatusAcademic.Save;
        var results = await studentRecordApi.AddAcademicDetailsAsync(Academicinformation);
        if (results is null)
        {
            Error = "Fill up All Requirements";
            return;
        }
        pageState.SetViewAcads(PageState.SaveAsDraftAcads.Save);
    }

    public async Task HandleSaveAsDraft()
    {
        Error = null;
        Academicinformation.Savestatus = SaveStatusAcademic.Save_As_Draft;
        var results = await studentRecordApi.AddAcademicDetailsAsync(Academicinformation);
        if (results is null)
        {
            Error = "Fill up All Requirements";
            return;
        }
        pageState.SetViewAcads(PageState.SaveAsDraftAcads.SaveASDraft);
    }
}