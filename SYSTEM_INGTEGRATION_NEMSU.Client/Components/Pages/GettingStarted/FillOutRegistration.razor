@page "/FillOutRegistration"
@using SYSTEM_INGTEGRATION_NEMSU.Client.Components.Pages.ModalRespond
@inject  IStudentRecordApiCommand studentRecordApi 
@inject PageState pageState
@rendermode InteractiveServer
@inject IJSRuntime JS
<div class="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-slate-100 flex flex-col items-center p-6">


    <div class="w-full max-w-7xl mb-6">
        <div class="flex items-center justify-between">

            <div class="breadcrumbs text-sm">
                <ul>
                    <li><NavLink href="/" class="text-cyan-600 hover:text-blue-700 font-medium">Home</NavLink></li>
                    <li><NavLink href="/loginuser" class="text-cyan-600 hover:text-blue-700 font-medium">Login</NavLink></li>
                    <li class="text-slate-600 font-semibold">Enrollment Application</li>
                </ul>
            </div>

          
            <label @onclick="()=> CompleteRegistration()" class="text-xs btn bg-gradient-to-r from-cyan-600 to-teal-700 hover:from-cyan-700 hover:to-teal-800 text-white border-0 shadow-lg">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
                Complete Registration
            </label>
        </div>
    </div>


    <div class="w-full max-w-7xl bg-white rounded-2xl shadow-2xl border border-slate-200 overflow-hidden">


        <div class="bg-gradient-to-br from-cyan-600 to-teal-700 px-6 py-4">
            <div class="flex items-center justify-between text-white">
                <div>
                    <h2 class="text-xl font-bold">Student Registration Form</h2>
                    <p class="text-sm text-blue-100 mt-1">Please fill out all required information accurately</p>
                </div>
                <div class="text-md text-blue-100">
                    You can save and continue later
                </div>
            </div>
        </div>

        <div class="p-6">
            <div class="grid lg:grid-cols-3 gap-6">


                <div class="bg-gradient-to-b from-slate-50 to-white border border-slate-200 rounded-xl shadow-sm hover:shadow-md transition-shadow overflow-hidden">
                    <div class="h-full overflow-y-auto max-h-[600px] p-6 scrollbar-hide">
                        @if (pageState.CurrentViewPerInfo == PageState.SaveAsDraftPerInfo.ViewInfo )
                        {
                            <PersonalInformation />
                        }
                        else if (pageState.CurrentViewPerInfo == PageState.SaveAsDraftPerInfo.SaveASDraft)
                        {
                            <SaveAsDraft />
                        }
                        else if (pageState.CurrentViewPerInfo == PageState.SaveAsDraftPerInfo.Save)
                        {
                            <SaveInformation />
                        }
                    
                    </div>
                </div>


                <div class="bg-gradient-to-b from-slate-50 to-white border border-slate-200 rounded-xl shadow-sm hover:shadow-md transition-shadow overflow-hidden">
                    <div class="h-full overflow-y-auto max-h-[600px] p-6 scrollbar-hide">
                        @if (pageState.CurrentViewAcads == PageState.SaveAsDraftAcads.ViewInfo)
                        {
                            <AcademicInformation />
                        }
                        else if (pageState.CurrentViewAcads == PageState.SaveAsDraftAcads.SaveASDraft)
                        {
                            <SaveAsDraft />
                        }
                        else if (pageState.CurrentViewAcads == PageState.SaveAsDraftAcads.Save)
                        {
                            <SaveInformation />
                        }
                    </div>
                </div>


                <div class="bg-gradient-to-b from-slate-50 to-white border border-slate-200 rounded-xl shadow-sm hover:shadow-md transition-shadow overflow-hidden">
                    <div class="h-full overflow-y-auto max-h-[600px] p-6 scrollbar-hide">
                        @if (pageState.CurrentViewContact == PageState.SaveAsDraftContact.ViewInfo)
                        {
                            <ContactInformation />
                        }
                        else if (pageState.CurrentViewContact == PageState.SaveAsDraftContact.SaveASDraft)
                        {
                            <SaveAsDraft />
                        }
                        else if (pageState.CurrentViewContact == PageState.SaveAsDraftContact.Save)
                        {
                            <SaveInformation />
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>

    @*  <!-- Timeline Section -->
    <div class="w-full max-w-7xl mt-8">
        @if (pageState.CurrentViewTimeline == PageState.Timeline.Fillout)
        {
            <Timeline />
        }
        else if (pageState.CurrentViewTimeline == PageState.Timeline.LoginReady)
        {
            <TimelineLoginReady />
        }
    </div>*@
    <FillOutFailed/>
    <FillOutSuccess/>



</div>


@code {

    public async Task CompleteRegistration()
    {
        var request = await studentRecordApi.CheckInformationAsync();
        if(request is false)
        {
            await JS.InvokeVoidAsync("eval", "document.getElementById('my_modal_fillout_failed').checked = true");
        }
        else
        {
            await JS.InvokeVoidAsync("eval", "document.getElementById('my_modal_fillout_success').checked = true");
        }
        StateHasChanged();
    }
   
  
    protected override void OnInitialized()
    {
        pageState.Onchange += StateHasChanged;
  
    }

    public void Dispose()
    {
        pageState.Onchange -= StateHasChanged;
    }
}